# 逆火程序设计

## 人物

### 消防员

消防员的逻辑主要分为移动，射击，跳跃，死亡，推桶。

移动使用SetActorLoaction进行人物设置，原生Movement输入有平滑效果，所以无法立即响应变化。在移动时进行朝向设置，如无射击，则使用移动方向设置人物方向，否则使用射击方向进行设置朝向。

射击系统使用扳机逻辑，当收到射击轮盘输入，则进行一次扳机按下时间，扳机按下后会循环生成子弹，每个子弹会进行随输入事件角度进行设置。

跳跃系统使用原生跳跃，受重力和跳跃初速度影响。

推桶使用碰撞判断，如果和桶有重叠部分，则进行手臂替换。

人物整个使用Avatar系统，在sprite上进行插槽打孔，然后将手臂插入插槽，这样随之的动作会真实一点。

### 小女孩

小女孩为阉割版的消防员，只有移动功能，并替换了图片。

## 怪物

所有怪物基于一个基类实现，核心在于状态切换。

怪物的逻辑主要分为巡逻，追逐，攻击，死亡。

移动使用charactermovement进行设置，通过射线检测切换巡逻/追逐状态，追逐时根据人物位置调整方向。

所有怪物可以通过与人物重叠造成伤害。

减少了动画帧数，来降低包大小。

### 怪物生成器

人物与它重叠时，会生成之前定义的各种怪物，然后销毁。

### 小火怪

小火怪除死亡状态以外，使用原生跳跃进行跳跃。

小火怪在靠近人物时，进行跳跃，与人物重叠，对人物产生伤害。

### 铁皮怪

铁皮怪，状态切换为：追逐->冲撞->释放技能->冲撞，根据抛物线计算技能速度，同时对怪物施加反向速度。

### 煤气罐怪

可以爆炸，通过内置时间，追逐距离，与人物距离三个因素进行判断。

### 铁皮桶怪

通过一个较大的重叠检测使得常态下可被推动。

设定了点燃生命值，其余带有"fire"tag的怪物与它重叠会使点燃生命值降低，降为零时，变为怪物巢穴，在看到人的情况下，可以不断产生小火怪。

### BOSS

丢出火球，地面火焰，瓦砾，都是怪物，其中地面火焰是持续伤害。

